<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PARADOX 3D MOBILE</title>
    <style>
        body { margin: 0; background: #000; color: #0f0; font-family: 'Courier New', monospace; overflow: hidden; touch-action: none; }
        #container { position: relative; width: 100vw; height: 100vh; overflow: hidden; }
        canvas { width: 100%; height: 100%; display: block; image-rendering: pixelated; }
        
        /* Controles Mobile */
        .mobile-btn { position: absolute; background: rgba(0, 255, 0, 0.1); border: 1px solid #0f0; color: #0f0; padding: 15px; z-index: 100; text-transform: uppercase; font-size: 12px; }
        #btn-cam { bottom: 20px; right: 20px; width: 80px; height: 80px; border-radius: 50%; }
        #btn-interrogate { bottom: 20px; left: 20px; display: none; }

        /* HUD */
        .stats { position: absolute; top: 10px; left: 10px; font-size: 14px; pointer-events: none; text-shadow: 1px 1px #000; }
        
        /* Interrogatório Input */
        #chat-wrap { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; background: rgba(0,0,0,0.9); border: 2px solid #0f0; padding: 15px; display: none; z-index: 200; }
        input { width: 100%; background: #000; border: 1px solid #0f0; color: #0f0; padding: 10px; box-sizing: border-box; margin-top: 10px; }
    </style>
</head>
<body>

<div id="container">
    <canvas id="gameCanvas"></canvas>
    
    <div class="stats">
        BATERIA: <span id="pwr">100</span>%<br>
        HORA: <span id="tm">12</span> AM
    </div>

    <button id="btn-cam" class="mobile-btn" onclick="toggleCams()">CAM</button>
    
    <div id="chat-wrap">
        <div id="ai-response">O QUE VOCÊ QUER SABER?</div>
        <input type="text" id="ai-input" placeholder="Toque aqui para perguntar...">
        <button class="mobile-btn" style="position:static; width:100%; margin-top:10px" onclick="processQuestion()">ENVIAR</button>
    </div>
</div>

<script>
/**
 * ENGINE: MOBILE RAYCASTER 3D (FNAF EDITION)
 * Renderização de ambiente 3D via projeção matemática.
 */

const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
let w, h;

function resize() {
    w = canvas.width = window.innerWidth;
    h = canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

// Estado do Jogo
let state = 'OFFICE';
let power = 100;
let time = 0;
let lookX = 0; // Olhar lateral (Mobile Swipe)
let touchStartX = 0;

// Configuração 3D do Escritório
const map = {
    cols: 8, rows: 8, size: 100,
    data: [
        1,1,1,1,1,1,1,1,
        1,0,0,0,0,0,0,1,
        1,0,0,0,0,0,0,1,
        1,0,0,0,0,0,0,1,
        1,0,0,0,0,0,0,1,
        1,0,0,0,0,0,0,1,
        1,0,0,0,0,0,0,1,
        1,1,1,1,1,1,1,1
    ]
};

// --- RENDERIZADOR 3D (RAYCASTING) ---
function draw3D() {
    // Chão e Teto
    ctx.fillStyle = "#050505"; ctx.fillRect(0, 0, w, h/2);
    ctx.fillStyle = "#111"; ctx.fillRect(0, h/2, w, h/2);

    const fov = 60 * Math.PI / 180;
    const step = fov / w;
    const rayAngleStart = (lookX * 0.005) - (fov / 2);

    for (let i = 0; i < w; i += 2) {
        let rayAngle = rayAngleStart + (i * step);
        let dist = 0;
        let x = 400, y = 400; // Posição fixa do jogador
        
        // Simulação de colisão de raio
        while(dist < 500) {
            dist += 2;
            let cx = x + Math.cos(rayAngle) * dist;
            let cy = y + Math.sin(rayAngle) * dist;
            
            let mi = Math.floor(cy / map.size) * map.cols + Math.floor(cx / map.size);
            if (map.data[mi] === 1) {
                // Renderiza coluna da parede
                let wallH = (map.size * h) / (dist * Math.cos(rayAngle - (lookX * 0.005)));
                let brightness = Math.max(0, 255 - dist/2);
                ctx.fillStyle = `rgb(0, ${brightness/4}, 0)`;
                ctx.fillRect(i, (h - wallH)/2, 2, wallH);
                break;
            }
        }
    }
}

// --- SISTEMA DE INTERROGATÓRIO ---
function startInterrogation() {
    state = 'INTERROGATION';
    document.getElementById('chat-wrap').style.display = 'block';
    document.getElementById('btn-cam').style.display = 'none';
}

function processQuestion() {
    const input = document.getElementById('ai-input');
    const res = document.getElementById('ai-response');
    const val = input.value.toLowerCase();
    
    if(val.includes("quem")) res.innerText = "EU SOU O QUE RESTOU DO METAL.";
    else if(val.includes("onde")) res.innerText = "ESTAMOS ATRÁS DAS CÂMERAS.";
    else if(val.includes("morte")) res.innerText = "DÓI MENOS QUE O REINÍCIO.";
    else res.innerText = "... (RUÍDO MECÂNICO) ...";
    
    input.value = "";
    // Adiciona tremor de tela (Tensão)
    lookX += (Math.random() - 0.5) * 50;
}

// --- LOOP E CONTROLES ---
function update() {
    if (state === 'OFFICE') {
        power -= 0.002;
        time += 0.01;
        document.getElementById('pwr').innerText = Math.floor(power);
        document.getElementById('tm').innerText = Math.floor(time/20) + 12;
        
        if (time > 120) startInterrogation();
        if (power <= 0) location.reload();
    }
}

function loop() {
    ctx.clearRect(0,0,w,h);
    if (state === 'OFFICE') draw3D();
    else if (state === 'INTERROGATION') {
        ctx.fillStyle = "black"; ctx.fillRect(0,0,w,h);
        // Desenha "olhos" 3D
        ctx.fillStyle = "red";
        ctx.beginPath();
        ctx.arc(w/2 - 50, h/2 - 100, 10, 0, 7);
        ctx.arc(w/2 + 50, h/2 - 100, 10, 0, 7);
        ctx.fill();
    }
    update();
    requestAnimationFrame(loop);
}

// Gestos Mobile (Swipe para olhar)
canvas.addEventListener('touchstart', e => {
    touchStartX = e.touches[0].clientX;
});
canvas.addEventListener('touchmove', e => {
    let diff = e.touches[0].clientX - touchStartX;
    lookX += diff * 2;
    touchStartX = e.touches[0].clientX;
});

function toggleCams() {
    // Efeito Glitch ao mudar
    ctx.fillStyle = "white"; ctx.fillRect(0,0,w,h);
    setTimeout(() => {
        alert("SISTEMA DE CÂMERAS FORA DE AR - MANUTENÇÃO NECESSÁRIA");
    }, 50);
}

loop();
</script>
</body>
</html>
